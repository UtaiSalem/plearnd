# NewsfeedV2 - หน้ากระดานข่าวเวอร์ชันใหม่

## ภาพรวม

NewsfeedV2 เป็นการอัปเกรดหน้ากระดานข่าวเดิมโดยยังคงฟังก์ชันการทำงานเดิมไว้ทั้งหมด แต่เพิ่มฟีเจอร์ใหม่ๆ เพื่อปรับปรุงประสบการณ์การใช้งาน

## ฟีเจอร์ใหม่ที่เพิ่มเข้ามา

### 1. การกรองเนื้อหา (Content Filtering)
- สามารถกรองโพสต์ตามประเภทได้:
  - ทั้งหมด
  - โพสต์ทั่วไป
  - แหล่งเรียนรู้
  - รายวิชา
  - การบริจาค

### 2. การค้นหา (Search)
- ค้นหาโพสต์จากเนื้อหา
- ค้นหาโพสต์จากชื่อผู้ใช้
- รองรับการค้นหาแบบ real-time

### 3. การแสดงผลโพสต์ใหม่ (Enhanced Post Display)
- การ์ดโพสต์ใหม่ที่ออกแบบให้ดูทันสมัยขึ้น
- แสดงประเภทของโพสต์ด้วยสีและไอคอนที่แตกต่างกัน
- รองรับการแสดงเนื้อหาแบบย่อ/ขยาย

### 4. ปุ่ม "Back to Top"
- ปุ่มสำหรับกลับไปด้านบนของหน้าเมื่อเลื่อนลงมากๆ
- ปรากฏเมื่อเลื่อนหน้าเว็บลงมากกว่า 300px

### 5. การจัดการการแจ้งเตือน (Notifications)
- แสดงการแจ้งเตือนเมื่อมีคนมา interact กับโพสต์ของเรา
- สามารถทำเครื่องหมายว่าอ่านแล้วได้
- แสดงจำนวนการแจ้งเตือนที่ยังไม่ได้อ่าน

## โครงสร้างไฟล์

### Frontend Components
```
resources/js/Pages/NewsfeedV2.vue                    # หน้าหลักของ NewsfeedV2
resources/js/PlearndComponents/newsfeed/
├── NewsfeedFilter.vue                               # Component สำหรับการกรองเนื้อหา
├── NewsfeedSearch.vue                               # Component สำหรับการค้นหา
├── NewsfeedNotification.vue                         # Component สำหรับการแจ้งเตือน
└── NewsfeedPostCard.vue                             # Component สำหรับการแสดงโพสต์แบบใหม่
```

### Backend
```
app/Http/Controllers/Play/NewsfeedV2Controller.php   # Controller สำหรับ NewsfeedV2
routes/play/newsfeed_v2.php                          # Routes สำหรับ NewsfeedV2
```

## การเข้าถึงหน้า NewsfeedV2

สามารถเข้าถึงหน้า NewsfeedV2 ได้ผ่าน URL: `/newsfeed-v2`

## API Endpoints

### 1. ดึงข้อมูล activities แบบแบ่งหน้า
```
GET /api/newsfeed-v2/activities?page=1&per_page=5&filter=all
```

### 2. ค้นหา activities
```
GET /api/newsfeed-v2/search?query=คำค้นหา&page=1&per_page=10
```

### 3. ล้าง cache
```
POST /api/newsfeed-v2/clear-cache
POST /api/newsfeed-v2/clear-activity-cache
```

## การปรับแต่ง

### การเปลี่ยนสีธีม
สามารถปรับแต่งสีของฟีเจอร์ต่างๆ ได้ในไฟล์ Vue components:

1. **สีประเภทโพสต์**: แก้ไขใน `NewsfeedPostCard.vue` ในฟังก์ชัน `getActivityTypeInfo`
2. **สีปุ่ม**: แก้ไขใน `NewsfeedV2.vue` ในส่วนของปุ่มต่างๆ
3. **สีการแจ้งเตือน**: แก้ไขใน `NewsfeedNotification.vue` ในฟังก์ชัน `getNotificationColor`

### การเปลี่ยนจำนวนโพสต์ต่อหน้า
สามารถปรับแต่งได้ใน `NewsfeedV2Controller.php` ในฟังก์ชัน `getPaginatedActivities`:
```php
$perPage = $request->get('per_page', 5); // เปลี่ยนจาก 5 เป็นตัวเลขที่ต้องการ
```

## การแก้ไขปัญหาที่อาจเกิดขึ้น

### 1. หน้าว่างเปล่า
- ตรวจสอบว่ามีข้อมูลใน database หรือไม่
- ตรวจสอบ log ใน `storage/logs/laravel.log` สำหรับข้อผิดพลาด

### 2. ฟีเจอร์ค้นหาไม่ทำงาน
- ตรวจสอบว่ามีการส่ง query ไปยัง API หรือไม่
- ตรวจสอบว่ามีข้อมูลในตาราง activities หรือไม่

### 3. การกรองไม่ทำงาน
- ตรวจสอบว่ามีการส่ง filter parameter ไปยัง API หรือไม่
- ตรวจสอบว่ามีข้อมูลในแต่ละประเภทหรือไม่

## การพัฒนาต่อ

### ฟีเจอร์ที่อาจเพิ่มในอนาคต
1. **การบันทึกความชอบ**: ให้ผู้ใช้บันทึกโพสต์ที่ชอบไว้ดูภายหลัง
2. **การแนะนำโพสต์**: แนะนำโพสต์ตามความสนใจของผู้ใช้
3. **การแชท**: เพิ่มฟีเจอร์แชทในหน้า newsfeed
4. **การโหวต**: ให้ผู้ใช้โหวตโพสต์
5. **การแชร์**: ให้ผู้ใช้แชร์โพสต์ไปยังแพลตฟอร์มอื่น

### การปรับปรุงประสิทธิภาพ
1. **การใช้ Redis Cache**: แทนที่จะใช้ file cache
2. **การโหลดแบบ Lazy Loading**: โหลดรูปภาพและข้อมูลเมื่อจำเป็น
3. **การบีบอัดรูปภาพ**: ลดขนาดรูปภาพโดยไม่ลดคุณภาพ
4. **การใช้ WebSocket**: สำหรับการอัปเดตข้อมูลแบบ real-time

## ข้อมูลติดต่อ

หากมีข้อสงสัยหรือต้องการรายงานปัญหา สามารถติดต่อทีมพัฒนาได้